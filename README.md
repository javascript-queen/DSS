# DSS - 3

### Тема домашней работы:
Группировка данных и оконные функции

### Описание папок репозитория:
- ```sql-scripts``` -- скрипт выполненного задания
- ```screenshots``` -- скрины с выполненными заданиями (1-7)

#### Цель домашней работы:
Научиться группировать и агрегировать данные, считать на их основе множество показателей.

#### Формулировка задания:
Дано два csv-файла с данными о клиентах (customer.csv) и их транзакциях (transaction.csv). Создать таблицы со следующими структурами и загрузить данные из csv-файлов. Детали приведены ниже.
Выполнить следующие запросы:
- Вывести распределение (количество) клиентов по сферам деятельности, отсортировав результат по убыванию количества. — (1 балл)
- Найти сумму транзакций за каждый месяц по сферам деятельности, отсортировав по месяцам и по сфере деятельности. — (1 балл)
- Вывести количество онлайн-заказов для всех брендов в рамках подтвержденных заказов клиентов из сферы IT. — (1 балл)
- Найти по всем клиентам сумму всех транзакций (list_price), максимум, минимум и количество транзакций, отсортировав результат по убыванию суммы транзакций и количества клиентов. Выполните двумя способами: используя только group by и используя только оконные функции. Сравните результат. — (2 балла)
- Найти имена и фамилии клиентов с минимальной/максимальной суммой транзакций за весь период (сумма транзакций не может быть null). Напишите отдельные запросы для минимальной и максимальной суммы. — (2 балла)
- Вывести только самые первые транзакции клиентов. Решить с помощью оконных функций. — (1 балл)
- Вывести имена, фамилии и профессии клиентов, между транзакциями которых был максимальный интервал (интервал вычисляется в днях) — (2 балла).
